<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gyan Mandala Nepal — Learning Portal</title>
<meta name="description" content="Gyan Mandala Nepal — interactive learning portal" />
<style>
  /* -------------------------
     Design tokens & base
     ------------------------- */
  :root{
    --bg-1:#fbfdff; --bg-2:#e9f6fb;
    --muted:#6b7280;
    --accent-orange: #ff7b00;       /* requested bold orange */
    --accent-red:#B03A2E;
    --accent-blue:#0B6FA4;
    --radius:14px;
    --ease: cubic-bezier(.22,.9,.38,1);
    --card-shadow: 0 14px 40px rgba(12,34,56,0.06);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;background: linear-gradient(160deg,var(--bg-1),var(--bg-2)); color:#071225;-webkit-font-smoothing:antialiased}
  button{font-family:inherit}

  /* -------------------------
     Header & logo
     ------------------------- */
  header{
    position:relative;
    padding:16px 20px;
    background: rgba(255,255,255,0.6);
    backdrop-filter: blur(6px);
    box-shadow: 0 8px 20px rgba(8,18,40,0.05);
  }
  #logo {
    width:78px;
    border-radius:10px;
    cursor:pointer;
    transition: transform .18s var(--ease), box-shadow .18s var(--ease);
  }
  #logo:hover{ transform: translateY(-2px) scale(1.03); box-shadow:0 12px 36px rgba(11,111,164,0.08); }

  main{ max-width:1120px; margin:18px auto; padding:0 18px 120px; }

  /* -------------------------
     Topbar (under logo) - visible on Form and Lessons only
     ------------------------- */
  .topbar {
    margin:14px auto;
    max-width:1120px;
    padding:12px 14px;
    border-radius:12px;
    background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(250,250,250,0.98));
    border: 1px solid rgba(0,0,0,0.04);
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    box-shadow: var(--card-shadow);
  }
  .top-left, .top-right{ display:flex; gap:12px; align-items:center; }
  .label{ font-size:13px; color:var(--muted); font-weight:700; margin-right:6px; }

  select, input[type="text"]{
    padding:10px 12px; border-radius:10px; border:1px solid #e6eef7; background:#fff; font-size:15px; min-width:160px;
    transition: box-shadow .12s var(--ease), border-color .12s var(--ease);
  }
  select:focus, input:focus{ box-shadow:0 12px 30px rgba(11,111,164,0.06); border-color:#cbe8ff; outline:none; }

  /* static display on lessons page */
  .static { font-weight:800; font-size:15px; color:var(--accent-orange); }

  .hidden{ display:none !important; }

  /* -------------------------
     Page containers & slide transitions
     ------------------------- */
  .page { opacity:0; transform: translateY(8px); transition: all .42s var(--ease); pointer-events:none; }
  .page.active { opacity:1; transform: translateY(0); pointer-events:auto; }
  .slide-in-right{ animation: slideInRight .36s var(--ease) forwards; }
  .slide-out-left{ animation: slideOutLeft .28s var(--ease) forwards; }
  .slide-in-left{ animation: slideInLeft .36s var(--ease) forwards; }
  .slide-out-right{ animation: slideOutRight .28s var(--ease) forwards; }
  @keyframes slideInRight { from{opacity:0; transform:translateX(18px);} to{opacity:1; transform:translateX(0);} }
  @keyframes slideOutLeft  { from{opacity:1; transform:translateX(0);} to{opacity:0; transform:translateX(-12px);} }
  @keyframes slideInLeft  { from{opacity:0; transform:translateX(-18px);} to{opacity:1; transform:translateX(0);} }
  @keyframes slideOutRight { from{opacity:1; transform:translateX(0);} to{opacity:0; transform:translateX(12px);} }

  /* -------------------------
     Home / Hero
     ------------------------- */
  .hero { text-align:center; padding:44px 12px 6px; }
  .welcome-line{ font-weight:800; line-height:1; font-size: clamp(28px,5.6vw,44px); opacity:0; transform:translateY(10px); animation: fadeUp .6s var(--ease) forwards; }
  .welcome-line.w1{ color:var(--accent-red); animation-delay:.12s }
  .welcome-line.w2{ color:var(--accent-blue); animation-delay:.36s }
  .welcome-line.w3{ color:var(--accent-orange); animation-delay:.60s }
  @keyframes fadeUp { to { opacity:1; transform:translateY(0);} }
  .hero-sub{ color:var(--muted); margin-top:12px; font-size:15px; max-width:860px; margin-left:auto; margin-right:auto }
  .cta { margin-top:20px; display:flex; gap:12px; justify-content:center; }

  .btn { padding:12px 18px; border-radius:12px; border:0; cursor:pointer; font-weight:800; font-size:15px; transition: transform .14s var(--ease), box-shadow .14s var(--ease); }
  .btn-primary { background: linear-gradient(90deg,#ff9a3d,var(--accent-orange)); color:white; box-shadow:0 12px 30px rgba(255,123,0,0.12); }
  .btn-primary:hover{ transform: translateY(-3px); box-shadow:0 22px 42px rgba(255,123,0,0.14); }
  .btn-ghost { background:transparent; border:1px solid rgba(11,111,164,0.08); color:var(--accent-blue); }

  /* -------------------------
     Form card
     ------------------------- */
  .card { background:#fff; border-radius:12px; padding:18px; box-shadow:var(--card-shadow); max-width:760px; margin:18px auto; }
  .form-row { display:flex; gap:12px; flex-wrap:wrap; margin-top:12px; align-items:center; }
  .field { min-width:220px; flex:1; display:flex; flex-direction:column; gap:8px; }
  label{ font-weight:700; color:#333; font-size:14px; }
  .hint { color:var(--muted); font-size:13px; margin-top:8px; }

  /* -------------------------
     Lessons header & centered grid
     ------------------------- */
  .lessons-intro { color:var(--muted); font-size:14px; margin-bottom:10px; text-align:center; }
  .lessons-grid {
    display:grid;
    grid-template-columns: repeat(5, 1fr);
    gap:20px;
    justify-items:center; /* center tiles horizontally inside each cell */
    align-items:center;
    margin-top:12px;
    max-width:980px;
    margin-left:auto; margin-right:auto;
  }
  @media (max-width:1200px){ .lessons-grid{ grid-template-columns: repeat(4,1fr); } }
  @media (max-width:900px){ .lessons-grid{ grid-template-columns: repeat(3,1fr); } }
  @media (max-width:600px){ .lessons-grid{ grid-template-columns: repeat(2,1fr); } }

  .lesson-tile {
    width:100%;
    max-width:220px;
    height:98px;
    border-radius:16px;
    background: linear-gradient(180deg,#fff,#fbfdff);
    border:1px solid rgba(0,0,0,0.04);
    font-weight:900;
    font-size:18px;
    color:#071225;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    box-shadow:0 10px 30px rgba(12,34,56,0.06);
    transition: transform .14s var(--ease), box-shadow .14s var(--ease), filter .12s var(--ease);
    position:relative;
    overflow:hidden;
  }
  .lesson-tile:hover{ transform: translateY(-10px) rotateX(2deg) scale(1.03); box-shadow:0 28px 64px rgba(12,34,56,0.12); filter: saturate(1.02); }

  .ripple { position:absolute; border-radius:50%; transform:scale(0); animation:ripple .6s linear; background: rgba(11,111,164,0.12); pointer-events:none; }
  @keyframes ripple { to { transform: scale(4); opacity:0; } }

  /* subject accent top-border (set on lessons section wrapper) */
  .subject-maths .lesson-tile{ border-top:10px solid #4a90e2; }
  .subject-english .lesson-tile{ border-top:10px solid #ff9a3d; }
  .subject-science .lesson-tile{ border-top:10px solid #2aa87a; }
  .subject-social .lesson-tile{ border-top:10px solid #ec5a9a; }
  .subject-nepali .lesson-tile{ border-top:10px solid #8b1f1f; }
  .subject-hamro .lesson-tile{ border-top:10px solid #cc6600; }

  /* -------------------------
     Modal
     ------------------------- */
  .overlay{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(8,12,20,0.42); z-index:120; }
  .overlay.open{ display:flex; }
  .modal{ background:#fff; border-radius:12px; padding:18px; width:min(720px,92%); box-shadow:0 28px 80px rgba(8,18,40,0.22); }
  .modal h3{ margin:0; }
  .modal .meta{ color:var(--muted); margin-top:6px; font-size:14px; }

  /* footer */
  footer{ position:fixed; left:0; right:0; bottom:0; background: linear-gradient(90deg,var(--accent-blue),#06607f); color:#fff; padding:12px 18px; text-align:center; font-weight:700; box-shadow:0 -6px 22px rgba(2,22,40,0.06); }
</style>
</head>
<body>
  <!-- Header: Logo only on Home, visible always but topbar controls input visibility -->
  <header>
    <img id="logo" src="GMN Logo.png" alt="GMN Logo" />
  </header>

  <!-- Topbar placed just under the logo; hidden on Home, visible on Form, static on Lessons -->
  <div id="topbar" class="topbar hidden" aria-hidden="true">
    <div class="top-left">
      <div class="label">Grade</div>
      <select id="gradeSelect" aria-label="Select Grade">
        <option value="">Select class</option>
      </select>
      <div id="gradeStatic" class="static hidden" aria-hidden="true">Grade: —</div>
    </div>

    <div class="top-right">
      <div class="label">Subject</div>
      <select id="subjectSelect" aria-label="Select Subject">
        <option value="">Select subject</option>
      </select>
      <div id="subjectStatic" class="static hidden" aria-hidden="true">Subject: —</div>
    </div>
  </div>

  <main>
    <!-- HOME PAGE -->
    <section id="homePage" class="page active" tabindex="-1">
      <div class="hero">
        <div class="welcome-lines" aria-hidden="false">
          <div class="welcome-line w1">Welcome</div>
          <div class="welcome-line w2">to</div>
          <div class="welcome-line w3">Gyan Mandala Nepal</div>
        </div>
        <p class="hero-sub">Warm, playful learning — choose your class and subject to begin.</p>
        <div class="cta">
          <button id="btnPortal" class="btn btn-primary">Go to Learning Portal</button>
          <button id="btnHelp" class="btn btn-ghost" onclick="alert('Choose class & subject and enter school name to auto-open lessons.')">How it works</button>
        </div>
      </div>
    </section>

    <!-- FORM PAGE -->
    <section id="formPage" class="page" tabindex="-1" style="display:none;">
      <div class="card">
        <h2>Student Details</h2>
        <div class="form-row">
          <div class="field"><label for="schoolInput">School Name</label><input id="schoolInput" type="text" placeholder="e.g., Everest School"></div>
          <div class="field"><label for="studentInput">Student Name</label><input id="studentInput" type="text" placeholder="e.g., Rishi (optional)"></div>
        </div>
        <div class="hint">Pick Grade & Subject from the top bar. Lessons will open automatically once School + Grade + Subject are set.</div>
        <div style="display:flex; gap:12px; margin-top:14px;">
          <button id="btnBackHome" class="btn btn-ghost">Back Home</button>
        </div>
      </div>
    </section>

    <!-- LESSONS PAGE -->
    <section id="lessonsPage" class="page" tabindex="-1" style="display:none;">
      <div style="max-width:1120px; margin:6px auto;">
        <nav style="text-align:center; margin-bottom:10px; color:var(--muted); font-size:14px;">
          <a id="crumbHome" style="cursor:pointer; color:var(--accent-blue); font-weight:700;">Home</a>
          <span> › </span>
          <a id="crumbChange" style="cursor:pointer; color:var(--accent-blue); font-weight:700;">Change</a>
          <span> › </span>
          <span id="crumbSubjectName" style="font-weight:900"></span>
        </nav>

        <div id="lessonsIntro" class="lessons-intro">20 lessons • click to preview</div>

        <div id="lessonsGrid" class="lessons-grid" role="list" aria-label="Lessons list">
          <!-- JS injects 20 tiles -->
        </div>
      </div>
    </section>
  </main>

  <footer>© 2025 Gyan Mandala Nepal — All Rights Reserved</footer>

  <!-- Modal -->
  <div id="overlay" class="overlay" aria-hidden="true" role="dialog">
    <div class="modal" role="document">
      <h3 id="modalTitle">Lesson</h3>
      <div id="modalMeta" class="meta">Subject • Class</div>
      <p id="modalBody" style="margin-top:10px;color:#334155;">Demo preview. Replace with real content or link.</p>
      <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:12px;">
        <button class="btn btn-ghost" onclick="closeModal()">Close</button>
        <button class="btn btn-primary" onclick="alert('Open lesson — demo')">Open</button>
      </div>
    </div>
  </div>

<script>
/* =====================================================
   App state and mappings
   ===================================================== */
const state = {
  grades: Array.from({length:10}, (_,i) => i+1),
  subjectsLow: [
    {id:'maths', name:'Mathematics'},
    {id:'english', name:'English'},
    {id:'hamro', name:'Hamro Serophero'},
    {id:'nepali', name:'Nepali'}
  ],
  subjectsHigh: [
    {id:'maths', name:'Mathematics'},
    {id:'english', name:'English'},
    {id:'science', name:'Science'},
    {id:'nepali', name:'Nepali'},
    {id:'social', name:'Social Studies'}
  ],
  subjectNames: {maths:'Mathematics', english:'English', hamro:'Hamro Serophero', nepali:'Nepali', science:'Science', social:'Social Studies'},
  page: 'home'
};

const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));

/* =====================================================
   Populate grade dropdown ONCE (no duplication)
   ===================================================== */
function populateGrades(){
  const sel = $('#gradeSelect');
  sel.innerHTML = '<option value="">Select class</option>';
  state.grades.forEach(g => {
    const opt = document.createElement('option');
    opt.value = g;
    opt.textContent = `Class ${g}`;
    sel.appendChild(opt);
  });
}

/* =====================================================
   Update subject dropdown for selected grade
   ===================================================== */
function updateSubjectsForGrade(grade) {
  const sel = $('#subjectSelect');
  sel.innerHTML = '<option value="">Select subject</option>';
  if(!grade) return;
  const list = grade <= 3 ? state.subjectsLow : state.subjectsHigh;
  list.forEach(s => {
    const opt = document.createElement('option');
    opt.value = s.id;
    opt.textContent = s.name;
    sel.appendChild(opt);
  });
}

/* =====================================================
   Show page with slide animation
   dir: 'right' (default) or 'left' — makes flow feel natural
   ===================================================== */
function showPage(target, dir='right') {
  const map = {home:'#homePage', form:'#formPage', lessons:'#lessonsPage'};
  if(state.page === target) return;
  const fromEl = document.querySelector(map[state.page]);
  const toEl = document.querySelector(map[target]);

  // topbar logic: visible on form & lessons, hidden on home
  if(target === 'home'){
    $('#topbar').classList.add('hidden'); $('#topbar').setAttribute('aria-hidden','true');
  } else {
    $('#topbar').classList.remove('hidden'); $('#topbar').removeAttribute('aria-hidden');
  }

  if(fromEl){
    fromEl.classList.remove('active');
    if(dir === 'right'){ fromEl.classList.add('slide-out-left'); setTimeout(()=>fromEl.classList.remove('slide-out-left'), 360); }
    else { fromEl.classList.add('slide-out-right'); setTimeout(()=>fromEl.classList.remove('slide-out-right'), 360); }
  }

  toEl.classList.add('active');
  if(dir === 'right'){ toEl.classList.add('slide-in-right'); setTimeout(()=>toEl.classList.remove('slide-in-right'), 380); }
  else { toEl.classList.add('slide-in-left'); setTimeout(()=>toEl.classList.remove('slide-in-left'), 380); }

  state.page = target;
  setTimeout(()=> toEl.focus && toEl.focus(), 220);
}

/* =====================================================
   Auto navigate when Grade, Subject selected AND School filled
   Student optional
   ===================================================== */
let autoTimer = null;
function tryAutoNavigate() {
  const grade = parseInt($('#gradeSelect').value);
  const subjectId = $('#subjectSelect').value;
  const school = $('#schoolInput').value.trim();
  const student = $('#studentInput').value.trim();

  // only auto navigate when all required are present
  if(grade && subjectId && school){
    // small debounce for user-friendliness
    if(autoTimer) clearTimeout(autoTimer);
    autoTimer = setTimeout(()=> {
      // validate combination
      if(!isValidCombination(grade, subjectId)){
        alert('Invalid class–subject combination for this grade.');
        return;
      }
      // set topbar to static display and render lessons
      syncTopbarToStatic(grade, subjectId, school, student);
      renderLessons(grade, subjectId, school, student);
      showPage('lessons','right');
    }, 260);
  }
}

/* =====================================================
   Validate subject membership per grade
   ===================================================== */
function isValidCombination(grade, subjectId){
  if(!grade || !subjectId) return false;
  const low = state.subjectsLow.map(s => s.id);
  const high = state.subjectsHigh.map(s => s.id);
  return (grade <= 3) ? low.includes(subjectId) : high.includes(subjectId);
}

/* =====================================================
   Sync topbar: form mode vs static lessons mode
   ===================================================== */
function syncTopbarToStatic(grade, subjectId, school, student){
  // hide selects, show static bold orange strings
  $('#gradeSelect').classList.add('hidden'); $('#subjectSelect').classList.add('hidden');
  $('#gradeStatic').classList.remove('hidden'); $('#subjectStatic').classList.remove('hidden');

  $('#gradeStatic').textContent = `Grade: ${grade}`;
  $('#subjectStatic').innerHTML = `Subject: <span style="font-weight:900;color:var(--accent-orange)">${escapeHtml(state.subjectNames[subjectId] || subjectId)}</span>`;

  // show school/student small in lessonsIntro (done in renderLessons)
}

/* =====================================================
   Render lessons grid (centered, attractive)
   ===================================================== */
function renderLessons(grade, subjectId, school='', student=''){
  $('#crumbSubjectName').textContent = state.subjectNames[subjectId] || subjectId;
  $('#lessonsIntro').textContent = `20 lessons • ${state.subjectNames[subjectId]} • Class ${grade}` + (school ? ` • ${school}` : '') + (student ? ` • ${student}` : '');

  // apply subject class to lessonsPage for accent
  const lessonsPage = $('#lessonsPage');
  lessonsPage.classList.remove('subject-maths','subject-english','subject-science','subject-social','subject-nepali','subject-hamro');
  lessonsPage.classList.add('subject-' + subjectId);

  const grid = $('#lessonsGrid');
  grid.innerHTML = '';
  for(let i=1;i<=20;i++){
    const tile = document.createElement('button');
    tile.className = 'lesson-tile';
    tile.setAttribute('aria-label', `Lesson ${i}`);
    tile.innerText = `Lesson ${i}`;

    tile.addEventListener('click', ev => { createRipple(ev, tile); openModal(grade, subjectId, i, school, student); });
    tile.addEventListener('keydown', e => { if(e.key==='Enter' || e.key===' ') { e.preventDefault(); tile.click(); } });

    grid.appendChild(tile);
  }
}

/* =====================================================
   Ripple effect
   ===================================================== */
function createRipple(e, el){
  const circle = document.createElement('span');
  circle.className = 'ripple';
  const rect = el.getBoundingClientRect();
  const size = Math.max(rect.width, rect.height);
  circle.style.width = circle.style.height = size + 'px';
  circle.style.left = (e.clientX - rect.left - size/2) + 'px';
  circle.style.top  = (e.clientY - rect.top - size/2) + 'px';
  el.appendChild(circle);
  setTimeout(()=> circle.remove(), 650);
}

/* =====================================================
   Modal
   ===================================================== */
function openModal(grade, subjectId, lessonNum, school, student){
  $('#modalTitle').textContent = `Lesson ${lessonNum}`;
  $('#modalMeta').textContent = `${state.subjectNames[subjectId]} • Class ${grade}` + (school ? ` • ${school}` : '') + (student ? ` • ${student}` : '');
  $('#modalBody').textContent = `Preview for Lesson ${lessonNum}. Replace with actual lesson content or link.`;
  $('#overlay').classList.add('open'); $('#overlay').setAttribute('aria-hidden','false');
}
function closeModal(){ $('#overlay').classList.remove('open'); $('#overlay').setAttribute('aria-hidden','true'); }
$('#overlay').addEventListener('click', e => { if(e.target === $('#overlay')) closeModal(); });
document.addEventListener('keyup', e => { if(e.key === 'Escape') closeModal(); });

/* =====================================================
   Helper & initialization
   ===================================================== */
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

document.addEventListener('DOMContentLoaded', ()=>{
  // populate grades once
  const gradeSel = $('#gradeSelect');
  gradeSel.innerHTML = '<option value="">Select class</option>';
  state.grades.forEach(g => { const opt=document.createElement('option'); opt.value=g; opt.textContent=`Class ${g}`; gradeSel.appendChild(opt); });

  // topbar initial hidden on home
  $('#topbar').classList.add('hidden'); $('#topbar').setAttribute('aria-hidden','true');

  // logo click: go home and reset topbar selects & statics
  $('#logo').addEventListener('click', ()=>{
    // reset
    $('#gradeSelect').value = '';
    $('#subjectSelect').innerHTML = '<option value="">Select subject</option>';
    $('#schoolInput').value = '';
    $('#studentInput').value = '';
    $('#gradeSelect').classList.remove('hidden'); $('#subjectSelect').classList.remove('hidden');
    $('#gradeStatic').classList.add('hidden'); $('#subjectStatic').classList.add('hidden');
    $('#topbar').classList.add('hidden'); $('#topbar').setAttribute('aria-hidden','true');
    showPage('home','left');
  });

  // portal button -> show form (topbar appears)
  $('#btnPortal').addEventListener('click', ()=> {
    $('#topbar').classList.remove('hidden'); $('#topbar').removeAttribute('aria-hidden');
    // ensure selects visible
    $('#gradeSelect').classList.remove('hidden'); $('#subjectSelect').classList.remove('hidden');
    $('#gradeStatic').classList.add('hidden'); $('#subjectStatic').classList.add('hidden');
    showPage('form','right');
    setTimeout(()=> $('#gradeSelect').focus(), 220);
  });

  // grade change -> update subjects and try auto nav
  $('#gradeSelect').addEventListener('change', (e) => {
    const g = parseInt(e.target.value);
    updateSubjectsForGrade(g);
    tryAutoNavigate();
  });

  // subject change -> try auto nav
  $('#subjectSelect').addEventListener('change', tryAutoNavigate);

  // school & student inputs
  $('#schoolInput').addEventListener('input', tryAutoNavigate);
  $('#studentInput').addEventListener('input', ()=> { /* student optional; reflect when lessons open */ });

  // Back Home from form
  $('#btnBackHome').addEventListener('click', ()=> {
    $('#topbar').classList.add('hidden'); $('#topbar').setAttribute('aria-hidden','true');
    showPage('home','left');
  });

  // Breadcrumb change -> go back to form to change selects (preserve values)
  $('#crumbChange').addEventListener('click', ()=> {
    $('#topbar').classList.remove('hidden'); $('#topbar').removeAttribute('aria-hidden');
    // Reveal selects (they may have been hidden)
    $('#gradeSelect').classList.remove('hidden'); $('#subjectSelect').classList.remove('hidden');
    $('#gradeStatic').classList.add('hidden'); $('#subjectStatic').classList.add('hidden');
    showPage('form','left');
  });

  // home crumb
  $('#crumbHome').addEventListener('click', ()=> {
    $('#topbar').classList.add('hidden'); $('#topbar').setAttribute('aria-hidden','true');
    showPage('home','left');
  });

  // initial page is home; no duplicates in grade select
});

/* =====================================================
   Expose tryAutoNavigate to call from change handlers
   ===================================================== */
function tryAutoNavigate(){ /* declared earlier; redeclare to ensure availability */ 
  const grade = parseInt($('#gradeSelect').value);
  const subjectId = $('#subjectSelect').value;
  const school = $('#schoolInput').value.trim();
  const student = $('#studentInput').value.trim();

  if(grade && subjectId && school){
    if(!isValidCombination(grade, subjectId)){
      // invalid combination — keep the selects visible and alert
      alert('Invalid class–subject combination for this grade.');
      return;
    }
    // hide selects, show static orange bold on topbar
    $('#gradeSelect').classList.add('hidden'); $('#subjectSelect').classList.add('hidden');
    $('#gradeStatic').classList.remove('hidden'); $('#subjectStatic').classList.remove('hidden');
    $('#gradeStatic').textContent = `Grade: ${grade}`;
    $('#subjectStatic').innerHTML = `Subject: <span style="font-weight:900;color:var(--accent-orange)">${escapeHtml(state.subjectNames[subjectId]||subjectId)}</span>`;

    // render and navigate
    renderLessons(grade, subjectId, school, student);
    showPage('lessons','right');
  }
}
</script>
</body>
</html>

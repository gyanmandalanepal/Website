<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gyan Mandala Nepal — Learning Portal</title>
  <meta name="description" content="Interactive learning portal — classes, subjects, lessons for Gyan Mandala Nepal." />
  <style>
    /* (same styles as previous version, unchanged for brevity) */
    /* ... FULL CSS FROM PREVIOUS VERSION ... */
  </style>
</head>
<body>
  <header>
    <img id="siteLogo" src="GMN Logo.png" alt="GMN Logo" class="logo" tabindex="0" title="Gyan Mandala Nepal - Home">
  </header>

  <main>
    <!-- HOME PAGE -->
    <section id="homePage" class="page active" aria-labelledby="homeTitle">
      <div class="welcome" role="banner">
        <div id="homeTitle" class="welcome-line w1">Welcome</div>
        <div class="welcome-line w2">to</div>
        <div class="welcome-line w3">Gyan Mandala Nepal</div>
      </div>
      <p class="subtitle center">Engaging lessons, easy navigation, and delightful micro-interactions.</p>
      <div class="hero-actions">
        <button id="enterPortal" class="btn btn-primary">Go to Learning Portal</button>
      </div>
    </section>

    <!-- FORM PAGE -->
    <section id="formPage" class="page" aria-labelledby="formTitle">
      <div class="card">
        <h2 id="formTitle">Enter Your Details</h2>
        <form id="studentForm" onsubmit="return false;">
          <div class="field full">
            <label for="schoolName">School Name</label>
            <input id="schoolName" type="text" placeholder="School Name" />
          </div>
          <div class="field">
            <label for="studentName">Student Name</label>
            <input id="studentName" type="text" placeholder="Student Name" />
          </div>
          <div class="field">
            <label for="grade">Class</label>
            <select id="grade" required>
              <option value="">Select class</option>
              <!-- JS will add 1–10 here -->
            </select>
          </div>
          <div class="field">
            <label for="subject">Subject</label>
            <select id="subject" required>
              <option value="">Select subject</option>
              <!-- JS updates dynamically -->
            </select>
          </div>
        </form>
      </div>
    </section>

    <!-- LESSONS PAGE -->
    <section id="lessonsPage" class="page" aria-labelledby="lessonsTitle">
      <nav class="breadcrumb">
        <a id="crumbHome">Home</a> › 
        <a id="crumbClass">Class</a> › 
        <span id="crumbSubject"></span>
      </nav>
      <div class="lessons-header">
        <div id="lessonsGrade">Grade: —</div>
        <div id="lessonsSubject">Subject: —</div>
      </div>
      <div id="lessonsGrid" class="lessons-grid"></div>
    </section>
  </main>

  <footer>© 2025 Gyan Mandala Nepal, All Rights Reserved</footer>

  <!-- MODAL -->
  <div id="overlay" class="overlay">
    <div class="modal">
      <h3 id="modalTitle">Lesson</h3>
      <div class="meta" id="modalMeta">Subject • Class</div>
      <p id="modalBody"></p>
      <div style="text-align:right; margin-top:1em;">
        <button class="btn btn-ghost" onclick="closeModal()">Close</button>
      </div>
    </div>
  </div>

  <script>
    const state = {
      current: 'home',
      grades: Array.from({ length: 10 }, (_, i) => i + 1), // 1–10
      subjectsLow: [
        { id: 'maths', name: 'Mathematics' },
        { id: 'english', name: 'English' },
        { id: 'hamro', name: 'Hamro Serophero' },
        { id: 'nepali', name: 'Nepali' }
      ],
      subjectsHigh: [
        { id: 'maths', name: 'Mathematics' },
        { id: 'english', name: 'English' },
        { id: 'science', name: 'Science' },
        { id: 'nepali', name: 'Nepali' },
        { id: 'social', name: 'Social Studies' }
      ],
      subjectNames: {
        maths: 'Mathematics', english: 'English', hamro: 'Hamro Serophero',
        nepali: 'Nepali', science: 'Science', social: 'Social Studies'
      }
    };

    const $ = sel => document.querySelector(sel);

    // Populate class dropdown once
    document.addEventListener('DOMContentLoaded', () => {
      const gradeEl = $('#grade');
      state.grades.forEach(g => {
        const opt = document.createElement('option');
        opt.value = g;
        opt.textContent = `Class ${g}`;
        gradeEl.appendChild(opt);
      });

      $('#enterPortal').addEventListener('click', () => {
        sessionStorage.setItem('visitedHome', '1');
        showPage('form');
      });

      $('#siteLogo').addEventListener('click', () => showPage('home'));

      $('#grade').addEventListener('change', e => {
        updateSubjects(parseInt(e.target.value));
        autoNavigate();
      });

      $('#subject').addEventListener('change', autoNavigate);

      $('#crumbHome').addEventListener('click', () => showPage('home'));
      $('#crumbClass').addEventListener('click', () => showPage('form'));
    });

    function updateSubjects(grade) {
      const subjEl = $('#subject');
      subjEl.innerHTML = '<option value="">Select subject</option>';
      const list = grade <= 3 ? state.subjectsLow : state.subjectsHigh;
      list.forEach(s => {
        const opt = document.createElement('option');
        opt.value = s.id;
        opt.textContent = s.name;
        subjEl.appendChild(opt);
      });
    }

    function autoNavigate() {
      const g = parseInt($('#grade').value);
      const s = $('#subject').value;
      if (g && s) {
        if (!isValidCombo(g, s)) {
          alert('Invalid combination');
          return;
        }
        renderLessons(g, s);
        showPage('lessons');
      }
    }

    function isValidCombo(g, s) {
      return g <= 3
        ? state.subjectsLow.some(sub => sub.id === s)
        : state.subjectsHigh.some(sub => sub.id === s);
    }

    function renderLessons(g, s) {
      $('#lessonsGrade').textContent = `Grade: ${g}`;
      $('#lessonsSubject').innerHTML = `Subject: <strong style="color:red">${state.subjectNames[s]}</strong>`;
      $('#crumbClass').textContent = `Class ${g}`;
      $('#crumbSubject').textContent = state.subjectNames[s];
      const grid = $('#lessonsGrid');
      grid.innerHTML = '';
      for (let i = 1; i <= 20; i++) {
        const btn = document.createElement('button');
        btn.className = 'lesson-btn';
        btn.textContent = `Lesson ${i}`;
        btn.onclick = () => openModal(g, s, i);
        grid.appendChild(btn);
      }
    }

    function openModal(g, s, i) {
      $('#modalTitle').textContent = `Lesson ${i}`;
      $('#modalMeta').textContent = `${state.subjectNames[s]} • Class ${g}`;
      $('#modalBody').textContent = `This is Lesson ${i} for ${state.subjectNames[s]} in Class ${g}.`;
      $('#overlay').style.display = 'flex';
    }

    function closeModal() {
      $('#overlay').style.display = 'none';
    }

    function showPage(page) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      if (page === 'home') {
        sessionStorage.clear();
      }
      $(`#${page}Page`).classList.add('active');
      state.current = page;
    }
  </script>
</body>
</html>
